/*!
 * jQuery Nav Walker v 0.0.1
 * https://github.com/plusdoptions/jquery-nav-walker
 *
 * Copyright 2015, Dorian Guilleminot <contact@plusdoption.com>
 * Licensed under the Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0).
 * http://creativecommons.org/licenses/by-sa/4.0/legalcode
*/
!function(t){"use-strict";function e(e,i){var n=this;this.nav=e,this.navClone=this.nav.clone().removeAttr("id").addClass("responsive-nav"),this.btn=this.navClone.find(".nav-walker-btn"),this.navo=this.nav.offset().top,this.navh=this.navClone.height(),this["break"]=null,this.ww=t(window).width(),this.wh=t(window).height(),this.active={activeIndex:[],linkArray:[],baseurl:""},this.construct(i),t("body").prepend(this.navClone),t(document).on("ready",function(){n.init();var e;t(window).on("resize",function(){clearTimeout(e),e=setTimeout(function(){n.resizeE(),n.scrollE()},300)}),t(window).on("scroll",function(t){n.scrollE()}),n.nav.find("a").on("click",function(){var e=r(n.active,t(this).attr("href"));n.search(e)}),n.btn.on("click",function(){n.toggleMenu()})}),t("body").on("treatNav",function(){n.treatNav()}),this.navClone.find("li").has("ul").children("a").on("click",function(e){u(t(this)),e.preventDefault()})}function i(t){var e=o(window.location.href),i=localStorage.getItem("active"),n=i?JSON.parse(i):void 0,a=this.nav.find("a").length,s=i&&n.linkArray.length==a?1:0;i&&s?data=n:data=this.storeData(e),this.resizeE(1),this.scrollE(),this.active=data,this.search(e)}function n(t){if(t)for(prop in t)this[prop]=t[prop];else this["break"]=t}function a(e){var i={},n=e.indexOf("/",7)+1,a=n?e.substring(0,n):e;i.baseurl=a,i.activeIndex=[],i.linkArray=[];var o=this.nav.find("ul").find("a"),h=[];return o.each(function(){var e=t(this).attr("href");e=e.match(a)?e:r(i,e),h.push(e)}),this.nav.find("ul").first().children("li").children("a").each(function(e){var n=t(this),o=n.attr("href"),h=n.parent("li").children("ul"),l=h.length;if(0!==e){var v=i.linkArray[e-1];indexParent=v.href?v.index+1:v[v.length-1].index+1}else indexParent=0;o=o.match(a)?o:r(i,o);var c=new s(o,indexParent);if(l){var d=[];d.push(c),h.find("a").each(function(e){var n=t(this).attr("href"),o=indexParent+e+1;n=n.match(a)?n:r(i,n);var h=new s(n,o);d.push(h)}),i.linkArray.push(d)}else i.linkArray.push(c)}),localStorage.setItem("active",JSON.stringify(i)),i}function s(t,e){this.href=t,this.index=e}function r(t,e){baseurl=t.baseurl,e,e.match("index.html")&&(e=e.replace("index.html",""));var i="/"===e[0]?baseurl+e.substring(1,e.length):baseurl+e;return i}function o(t){var e=t.indexOf("?"),i=-1;switch(-1!==e&&-1!==i){case-1!==i:splitIndex=e;break;case-1!==e:splitIndex=i;break;default:var n=i>e?e:i;splitIndex=n}var t=splitIndex?t.replace("index.html",""):t.substring(0,splitIndex).replace("index.html","");return t}function h(t){var e=this;t=t,0!==this.active.activeIndex.length&&(this.active.oldActiveIndex=this.active.activeIndex,this.active.activeIndex=[]),this.active.linkArray.forEach(function(i,n){if(i.href)l(i,t,e);else{var a=i;i.forEach(function(i){l(i,t,e,a)})}})}function l(t,e,i,n){if(t.href===e){console.log("url"),console.log(e),n&&n[0]!==t?i.active.activeIndex.push(n[0],t):i.active.activeIndex.push(t);var a=new CustomEvent("treatNav");document.body.dispatchEvent(a)}}function v(e){var i=this,n=this.nav.find("ul").find("a"),a=this.navClone.find("ul").find("a");this.active.oldActiveIndex&&this.active.oldActiveIndex.forEach(function(e){var s=e.index,r=t(n[s]),o=t(a[s]);i.removeActive(r),i.removeActive(o)}),this.active.activeIndex.forEach(function(e){var s=e.index,r=t(n[s]),o=t(a[s]);i.addActive(r),i.addActive(o)})}function c(){var e=t(window).scrollTop();return this.underBreak&&!e?(this.showNav(this.navClone),void this.defixeResNav()):void(e>=this.navo?(this.showNav(this.navClone),this.fixeResNav()):(this.hideNav(this.navClone),this.defixeResNav()))}function d(e){var i=t(window).width();(this.ww!=i||e)&&(i<=this["break"]?(this.showNav(this.navClone),this.hideNav(this.nav),this.underBreak=1,this.nav.addClass("is-breaked"),this.navClone.addClass("is-breaked")):(this.hideNav(this.navClone),this.showNav(this.nav),this.underBreak=0,this.nav.removeClass("is-breaked"),this.navClone.removeClass("is-breaked"),this.navClone.removeAttr("style"),this.navClone.find("ul").first().removeAttr("style"),this.navClone.find("ul ul").removeAttr("style"),this.navClone.find("li.is-open").removeClass("is-open")),this.navo=this.underBreak?0:this.nav.offset().top,this.navh=this.navClone.height(),this.ww=i)}function f(){if(this.underBreak){var t=this.navClone.find("ul").first();t.stop().slideToggle()}}function u(t){var e=t.parent("li"),i=e.children("ul");if(i.length){if(!i.children("li").first().hasClass("is-cloned")){var n=i.children("li").last().attr("class"),a=t.clone().wrap("<li class='"+n+" is-cloned'></li>").parent();i.prepend(a)}i.stop().slideToggle(),e.stop().toggleClass("is-open")}}function p(t){t.removeClass("is-hidden")}function x(t){t.addClass("is-hidden")}function C(){this.navClone.addClass("is-fixed")}function w(){this.navClone.removeClass("is-fixed")}function y(t){t.removeClass("is-active")}function g(t){t.addClass("is-active")}t.fn.navWalker=function(i){if("string"==typeof i){var n=t(this).data("navWalker");if(n)return arguments[1]?n.construct(i):n[arguments[0]].apply(n)}else t(this).each(function(){"number"==typeof i&&(i={"break":i}),options=t.extend({},t.fn.navWalker.defaults,i);var n=new e(t(this),options);t(this).data("navWalker",n)});return this},t.fn.navWalker.defaults=function(){this["break"]=700},e.prototype.construct=n,e.prototype.init=i,e.prototype.resizeE=d,e.prototype.scrollE=c,e.prototype.storeData=a,e.prototype.search=h,e.prototype.treatNav=v,e.prototype.toggleMenu=f,e.prototype.showNav=p,e.prototype.hideNav=x,e.prototype.fixeResNav=C,e.prototype.defixeResNav=w,e.prototype.addActive=g,e.prototype.removeActive=y}(jQuery);
